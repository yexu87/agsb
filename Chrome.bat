@echo off
chcp 65001 >nul
title Chrome分身创建工具

echo.
echo ========================================
echo           Chrome分身创建工具
echo ========================================
echo.

REM 以管理员权限运行PowerShell脚本
powershell -NoProfile -ExecutionPolicy Bypass -Command "& { [Console]::OutputEncoding = [System.Text.Encoding]::UTF8; $ErrorActionPreference = 'Stop'; try { Write-Host 'Chrome分身创建脚本启动中...' -ForegroundColor Green; Write-Host '================================================' -ForegroundColor Cyan; $DesktopPath = [Environment]::GetFolderPath('Desktop'); Write-Host '桌面路径: ' -NoNewline; Write-Host $DesktopPath -ForegroundColor Yellow; $UserDataPath = \"$DesktopPath\chrome\Chrome_UserData\"; $FilePath = \"$DesktopPath\chrome\Chrome_ShortCuts\"; $ChromePaths = @('C:\Program Files\Google\Chrome\Application\chrome.exe', 'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe', \"$env:LOCALAPPDATA\Google\Chrome\Application\chrome.exe\"); $TargetPath = $null; $WorkingDirectory = $null; foreach ($path in $ChromePaths) { if (Test-Path $path) { $TargetPath = $path; $WorkingDirectory = Split-Path $path -Parent; Write-Host '找到Chrome安装路径: ' -NoNewline; Write-Host $TargetPath -ForegroundColor Green; break; } }; if (-not $TargetPath) { Write-Host '错误: 未找到Chrome浏览器，请确保已安装Chrome！' -ForegroundColor Red; Write-Host '请手动安装Chrome浏览器后重新运行此脚本。' -ForegroundColor Yellow; Read-Host '按回车键退出'; exit 1; }; $array = 1..10; $ChromeMainPath = \"$DesktopPath\chrome\"; if (-not (Test-Path $ChromeMainPath)) { New-Item -ItemType Directory -Path $ChromeMainPath -Force | Out-Null; Write-Host '已创建目录: ' -NoNewline; Write-Host $ChromeMainPath -ForegroundColor Green; }; if (-not (Test-Path $UserDataPath)) { New-Item -ItemType Directory -Path $UserDataPath -Force | Out-Null; Write-Host '已创建目录: ' -NoNewline; Write-Host $UserDataPath -ForegroundColor Green; }; if (-not (Test-Path $FilePath)) { New-Item -ItemType Directory -Path $FilePath -Force | Out-Null; Write-Host '已创建目录: ' -NoNewline; Write-Host $FilePath -ForegroundColor Green; }; Write-Host '================================================' -ForegroundColor Cyan; Write-Host '开始创建Chrome分身快捷方式...' -ForegroundColor Yellow; foreach ($n in $array) { $x = $n.ToString(); $ShortcutFile = \"$FilePath\Chrome_$x.lnk\"; $WScriptShell = New-Object -ComObject WScript.Shell; $Shortcut = $WScriptShell.CreateShortcut($ShortcutFile); $Shortcut.TargetPath = $TargetPath; $Shortcut.Arguments = \"--user-data-dir=`\"$UserDataPath\$x`\"\"; $Shortcut.WorkingDirectory = $WorkingDirectory; $Shortcut.Description = \"Chrome Browser Profile $x\"; $Shortcut.Save(); [System.Runtime.Interopservices.Marshal]::ReleaseComObject($Shortcut) | Out-Null; [System.Runtime.Interopservices.Marshal]::ReleaseComObject($WScriptShell) | Out-Null; Write-Host '  [✓] 已创建快捷方式: ' -NoNewline; Write-Host \"Chrome_$x.lnk\" -ForegroundColor Green; }; Write-Host '================================================' -ForegroundColor Cyan; Write-Host '所有Chrome分身快捷方式创建完成！' -ForegroundColor Green; Write-Host '快捷方式位置: ' -NoNewline; Write-Host $FilePath -ForegroundColor Yellow; Write-Host '用户数据位置: ' -NoNewline; Write-Host $UserDataPath -ForegroundColor Yellow; Write-Host '================================================' -ForegroundColor Cyan; Write-Host '使用说明:' -ForegroundColor Cyan; Write-Host '1. 打开文件夹: ' -NoNewline; Write-Host $FilePath -ForegroundColor White; Write-Host '2. 双击任意 Chrome_X.lnk 文件启动对应的Chrome分身' -ForegroundColor White; Write-Host '3. 每个分身都有独立的登录状态、插件和设置' -ForegroundColor White; Write-Host '================================================' -ForegroundColor Cyan; } catch { Write-Host '错误: ' -NoNewline -ForegroundColor Red; Write-Host $_.Exception.Message -ForegroundColor Red; Write-Host '脚本执行失败，请检查错误信息。' -ForegroundColor Yellow; } finally { Write-Host '按任意键退出...' -ForegroundColor Gray; Read-Host; } }"

pause